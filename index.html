<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Soalat_Test_School</title>

<script src="questions.js"></script>

<style>
body{
  font-family:tahoma;
  background:#f4f6f8;
  text-align:center;
}
.box{
  background:#fff;
  padding:20px;
  margin:20px auto;
  width:90%;
  max-width:500px;
  border-radius:10px;
}
button{
  padding:10px 20px;
  font-size:16px;
  margin:6px;
}
</style>
</head>

<body>

<div class="box" id="startBox">
  <h2>آزمون آنلاین</h2>
  <input id="name" placeholder="نام شرکت‌کننده">
  <br><br>
  <button onclick="startExam()">شروع</button>
</div>

<div class="box" id="examBox" style="display:none">
  <h3 id="q"></h3>
  <div id="opts"></div>
</div>

<div class="box" id="endBox" style="display:none">
  <h2 id="result"></h2>
  <button onclick="location.reload()">خروج</button>
</div>

<script>
let qs = [];
let i = 0;
let score = 0;

function shuffle(arr){
  return arr.sort(()=>Math.random()-0.5);
}

function startExam(){
  const n = document.getElementById("name").value.trim();
  if(!n){
    alert("نام را وارد کنید");
    return;
  }

  qs = shuffle(HISTORY).slice(0,4)
        .concat(shuffle(GEOGRAPHY).slice(0,4))
        .concat(shuffle(MIXED).slice(0,2));

  qs = shuffle(qs);

  document.getElementById("startBox").style.display="none";
  document.getElementById("examBox").style.display="block";

  showQ();
}

function showQ(){
  if(i >= qs.length){
    finish();
    return;
  }

  document.getElementById("q").innerText = qs[i].q;

  const options = shuffle([...qs[i].a]);
  document.getElementById("opts").innerHTML =
    options.map(o =>
      <button onclick="answer('${o}')">${o}</button>
    ).join("<br>");
}

function answer(x){
  if(x === qs[i].c) score++;
  i++;
  showQ();
}

function finish(){
  document.getElementById("examBox").style.display="none";
  document.getElementById("endBox").style.display="block";
  document.getElementById("result").innerText =
    "نمره شما: " + score + " از 10";
}
</script>

</body>
</html>
